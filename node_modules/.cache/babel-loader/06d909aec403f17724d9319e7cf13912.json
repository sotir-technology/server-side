{"remainingRequest":"C:\\xampp\\htdocs\\GIT\\server-side\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!C:\\xampp\\htdocs\\GIT\\server-side\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\xampp\\htdocs\\GIT\\server-side\\src\\auth\\authService.js","dependencies":[{"path":"C:\\xampp\\htdocs\\GIT\\server-side\\src\\auth\\authService.js","mtime":1567376724469},{"path":"C:\\xampp\\htdocs\\GIT\\server-side\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\xampp\\htdocs\\GIT\\server-side\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\xampp\\htdocs\\GIT\\server-side\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.date.now\";\nimport \"core-js/modules/es6.array.index-of\";\nimport \"core-js/modules/es6.string.sub\";\nimport \"core-js/modules/es6.function.name\";\nimport _classCallCheck from \"C:\\\\xampp\\\\htdocs\\\\GIT\\\\server-side\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/classCallCheck\";\nimport _inherits from \"C:\\\\xampp\\\\htdocs\\\\GIT\\\\server-side\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/inherits\";\nimport _createClass from \"C:\\\\xampp\\\\htdocs\\\\GIT\\\\server-side\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\xampp\\\\htdocs\\\\GIT\\\\server-side\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\xampp\\\\htdocs\\\\GIT\\\\server-side\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/getPrototypeOf\";\nimport _assertThisInitialized from \"C:\\\\xampp\\\\htdocs\\\\GIT\\\\server-side\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/assertThisInitialized\";\nimport _defineProperty from \"C:\\\\xampp\\\\htdocs\\\\GIT\\\\server-side\\\\node_modules\\\\@babel\\\\runtime/helpers/builtin/es6/defineProperty\";\nimport auth0 from 'auth0-js';\nimport EventEmitter from 'events';\nimport authConfig from '../../auth_config.json'; // 'loggedIn' is used in other parts of application. So, Don't forget to change there also\n\nvar localStorageKey = 'loggedIn';\nvar tokenExpiryKey = 'tokenExpiry';\nvar loginEvent = 'loginEvent';\nvar webAuth = new auth0.WebAuth({\n  domain: authConfig.domain,\n  redirectUri: window.location.origin + process.env.BASE_URL + \"callback\",\n  clientID: authConfig.clientId,\n  responseType: 'id_token',\n  scope: 'openid profile email'\n});\n\nvar AuthService =\n/*#__PURE__*/\nfunction (_EventEmitter) {\n  function AuthService() {\n    var _getPrototypeOf2;\n\n    var _temp, _this;\n\n    _classCallCheck(this, AuthService);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _possibleConstructorReturn(_this, (_temp = _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AuthService)).call.apply(_getPrototypeOf2, [this].concat(args))), _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"idToken\", null), _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"profile\", null), _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"tokenExpiry\", null), _temp));\n  }\n\n  _createClass(AuthService, [{\n    key: \"login\",\n    // Starts the user login flow\n    value: function login(customState) {\n      webAuth.authorize({\n        appState: customState\n      });\n    } // Handles the callback request from Auth0\n\n  }, {\n    key: \"handleAuthentication\",\n    value: function handleAuthentication() {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n        webAuth.parseHash(function (err, authResult) {\n          if (err) {\n            alert(err.error + '. Detailed error can be found in console.');\n            reject(err);\n          } else {\n            _this2.localLogin(authResult);\n\n            resolve(authResult.idToken);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"localLogin\",\n    value: function localLogin(authResult) {\n      this.idToken = authResult.idToken;\n      this.profile = authResult.idTokenPayload; // Convert the JWT expiry time from seconds to milliseconds\n\n      this.tokenExpiry = new Date(this.profile.exp * 1000);\n      localStorage.setItem(tokenExpiryKey, this.tokenExpiry);\n      localStorage.setItem(localStorageKey, 'true');\n      localStorage.setItem('userInfo', JSON.stringify({\n        displayName: this.profile.name,\n        email: this.profile.email,\n        photoURL: this.profile.picture,\n        providerId: this.profile.sub.substr(0, this.profile.sub.indexOf('|')),\n        uid: this.profile.sub\n      }));\n      this.emit(loginEvent, {\n        loggedIn: true,\n        profile: authResult.idTokenPayload,\n        state: authResult.appState || {}\n      });\n    }\n  }, {\n    key: \"renewTokens\",\n    value: function renewTokens() {\n      var _this3 = this;\n\n      // reject can be used as parameter in promise for using reject\n      return new Promise(function (resolve) {\n        if (localStorage.getItem(localStorageKey) !== \"true\") {// return reject(\"Not logged in\");\n        }\n\n        webAuth.checkSession({}, function (err, authResult) {\n          if (err) {// reject(err);\n          } else {\n            _this3.localLogin(authResult);\n\n            resolve(authResult);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"logOut\",\n    value: function logOut() {\n      localStorage.removeItem(localStorageKey);\n      localStorage.removeItem(tokenExpiryKey);\n      localStorage.removeItem('userInfo');\n      this.idToken = null;\n      this.tokenExpiry = null;\n      this.profile = null;\n      webAuth.logout({\n        returnTo: window.location.origin + process.env.BASE_URL\n      });\n      this.emit(loginEvent, {\n        loggedIn: false\n      });\n    }\n  }, {\n    key: \"isAuthenticated\",\n    value: function isAuthenticated() {\n      return new Date(Date.now()) < new Date(localStorage.getItem(tokenExpiryKey)) && localStorage.getItem(localStorageKey) === 'true';\n    }\n  }]);\n\n  _inherits(AuthService, _EventEmitter);\n\n  return AuthService;\n}(EventEmitter);\n\nexport default new AuthService();",{"version":3,"sources":["C:\\xampp\\htdocs\\GIT\\server-side\\src\\auth\\authService.js"],"names":["auth0","EventEmitter","authConfig","localStorageKey","tokenExpiryKey","loginEvent","webAuth","WebAuth","domain","redirectUri","window","location","origin","process","env","BASE_URL","clientID","clientId","responseType","scope","AuthService","customState","authorize","appState","Promise","resolve","reject","parseHash","err","authResult","alert","error","localLogin","idToken","profile","idTokenPayload","tokenExpiry","Date","exp","localStorage","setItem","JSON","stringify","displayName","name","email","photoURL","picture","providerId","sub","substr","indexOf","uid","emit","loggedIn","state","getItem","checkSession","removeItem","logout","returnTo","now"],"mappings":";;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,UAAlB;AACA,OAAOC,YAAP,MAAyB,QAAzB;AACA,OAAOC,UAAP,MAAuB,wBAAvB,C,CAEA;;AACA,IAAMC,eAAe,GAAG,UAAxB;AAEA,IAAMC,cAAc,GAAG,aAAvB;AACA,IAAMC,UAAU,GAAG,YAAnB;AAEA,IAAMC,OAAO,GAAG,IAAIN,KAAK,CAACO,OAAV,CAAkB;AAC9BC,EAAAA,MAAM,EAAEN,UAAU,CAACM,MADW;AAE9BC,EAAAA,WAAW,EAAEC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GAAyBC,OAAO,CAACC,GAAR,CAAYC,QAArC,GAAgD,UAF/B;AAG9BC,EAAAA,QAAQ,EAAEd,UAAU,CAACe,QAHS;AAI9BC,EAAAA,YAAY,EAAE,UAJgB;AAK9BC,EAAAA,KAAK,EAAE;AALuB,CAAlB,CAAhB;;IAQMC,W;;;;;;;;;;;;;;uRACQ,I,qFACA,I,yFACI,I;;;;;AAEd;0BACMC,W,EAAa;AACff,MAAAA,OAAO,CAACgB,SAAR,CAAkB;AACdC,QAAAA,QAAQ,EAAEF;AADI,OAAlB;AAGH,K,CAED;;;;2CACuB;AAAA;;AACnB,aAAO,IAAIG,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACpCpB,QAAAA,OAAO,CAACqB,SAAR,CAAkB,UAACC,GAAD,EAAMC,UAAN,EAAqB;AACnC,cAAID,GAAJ,EAAS;AACLE,YAAAA,KAAK,CAACF,GAAG,CAACG,KAAJ,GAAY,2CAAb,CAAL;AACAL,YAAAA,MAAM,CAACE,GAAD,CAAN;AACH,WAHD,MAGO;AACH,YAAA,MAAI,CAACI,UAAL,CAAgBH,UAAhB;;AACAJ,YAAAA,OAAO,CAACI,UAAU,CAACI,OAAZ,CAAP;AACH;AACJ,SARD;AASH,OAVM,CAAP;AAWH;;;+BAEUJ,U,EAAY;AACnB,WAAKI,OAAL,GAAeJ,UAAU,CAACI,OAA1B;AACA,WAAKC,OAAL,GAAeL,UAAU,CAACM,cAA1B,CAFmB,CAInB;;AACA,WAAKC,WAAL,GAAmB,IAAIC,IAAJ,CAAS,KAAKH,OAAL,CAAaI,GAAb,GAAmB,IAA5B,CAAnB;AACAC,MAAAA,YAAY,CAACC,OAAb,CAAqBpC,cAArB,EAAqC,KAAKgC,WAA1C;AACAG,MAAAA,YAAY,CAACC,OAAb,CAAqBrC,eAArB,EAAsC,MAAtC;AACAoC,MAAAA,YAAY,CAACC,OAAb,CAAqB,UAArB,EAAiCC,IAAI,CAACC,SAAL,CAAe;AAC5CC,QAAAA,WAAW,EAAE,KAAKT,OAAL,CAAaU,IADkB;AAE5CC,QAAAA,KAAK,EAAE,KAAKX,OAAL,CAAaW,KAFwB;AAG5CC,QAAAA,QAAQ,EAAE,KAAKZ,OAAL,CAAaa,OAHqB;AAI5CC,QAAAA,UAAU,EAAE,KAAKd,OAAL,CAAae,GAAb,CAAiBC,MAAjB,CAAwB,CAAxB,EAA2B,KAAKhB,OAAL,CAAae,GAAb,CAAiBE,OAAjB,CAAyB,GAAzB,CAA3B,CAJgC;AAK5CC,QAAAA,GAAG,EAAE,KAAKlB,OAAL,CAAae;AAL0B,OAAf,CAAjC;AAQA,WAAKI,IAAL,CAAUhD,UAAV,EAAsB;AAClBiD,QAAAA,QAAQ,EAAE,IADQ;AAElBpB,QAAAA,OAAO,EAAEL,UAAU,CAACM,cAFF;AAGlBoB,QAAAA,KAAK,EAAE1B,UAAU,CAACN,QAAX,IAAuB;AAHZ,OAAtB;AAKH;;;kCAEa;AAAA;;AACV;AACA,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC5B,YAAIc,YAAY,CAACiB,OAAb,CAAqBrD,eAArB,MAA0C,MAA9C,EAAsD,CAClD;AACH;;AAEDG,QAAAA,OAAO,CAACmD,YAAR,CAAqB,EAArB,EAAyB,UAAC7B,GAAD,EAAMC,UAAN,EAAqB;AAC1C,cAAID,GAAJ,EAAS,CACL;AACH,WAFD,MAEO;AACH,YAAA,MAAI,CAACI,UAAL,CAAgBH,UAAhB;;AACAJ,YAAAA,OAAO,CAACI,UAAD,CAAP;AACH;AACJ,SAPD;AAQH,OAbM,CAAP;AAcH;;;6BAEQ;AACLU,MAAAA,YAAY,CAACmB,UAAb,CAAwBvD,eAAxB;AACAoC,MAAAA,YAAY,CAACmB,UAAb,CAAwBtD,cAAxB;AACAmC,MAAAA,YAAY,CAACmB,UAAb,CAAwB,UAAxB;AAEA,WAAKzB,OAAL,GAAe,IAAf;AACA,WAAKG,WAAL,GAAmB,IAAnB;AACA,WAAKF,OAAL,GAAe,IAAf;AAEA5B,MAAAA,OAAO,CAACqD,MAAR,CAAe;AACXC,QAAAA,QAAQ,EAAElD,MAAM,CAACC,QAAP,CAAgBC,MAAhB,GAAyBC,OAAO,CAACC,GAAR,CAAYC;AADpC,OAAf;AAIA,WAAKsC,IAAL,CAAUhD,UAAV,EAAsB;AAAEiD,QAAAA,QAAQ,EAAE;AAAZ,OAAtB;AACH;;;sCAEiB;AACd,aACI,IAAIjB,IAAJ,CAASA,IAAI,CAACwB,GAAL,EAAT,IAAuB,IAAIxB,IAAJ,CAASE,YAAY,CAACiB,OAAb,CAAqBpD,cAArB,CAAT,CAAvB,IACAmC,YAAY,CAACiB,OAAb,CAAqBrD,eAArB,MAA0C,MAF9C;AAIH;;;;;;EAzFqBF,Y;;AA4F1B,eAAe,IAAImB,WAAJ,EAAf","sourcesContent":["import auth0 from 'auth0-js';\r\nimport EventEmitter from 'events';\r\nimport authConfig from '../../auth_config.json';\r\n\r\n// 'loggedIn' is used in other parts of application. So, Don't forget to change there also\r\nconst localStorageKey = 'loggedIn';\r\n\r\nconst tokenExpiryKey = 'tokenExpiry';\r\nconst loginEvent = 'loginEvent';\r\n\r\nconst webAuth = new auth0.WebAuth({\r\n    domain: authConfig.domain,\r\n    redirectUri: window.location.origin + process.env.BASE_URL + \"callback\",\r\n    clientID: authConfig.clientId,\r\n    responseType: 'id_token',\r\n    scope: 'openid profile email'\r\n});\r\n\r\nclass AuthService extends EventEmitter {\r\n    idToken = null;\r\n    profile = null;\r\n    tokenExpiry = null;\r\n\r\n    // Starts the user login flow\r\n    login(customState) {\r\n        webAuth.authorize({\r\n            appState: customState\r\n        });\r\n    }\r\n\r\n    // Handles the callback request from Auth0\r\n    handleAuthentication() {\r\n        return new Promise((resolve, reject) => {\r\n            webAuth.parseHash((err, authResult) => {\r\n                if (err) {\r\n                    alert(err.error + '. Detailed error can be found in console.');\r\n                    reject(err);\r\n                } else {\r\n                    this.localLogin(authResult);\r\n                    resolve(authResult.idToken);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    localLogin(authResult) {\r\n        this.idToken = authResult.idToken;\r\n        this.profile = authResult.idTokenPayload;\r\n\r\n        // Convert the JWT expiry time from seconds to milliseconds\r\n        this.tokenExpiry = new Date(this.profile.exp * 1000);\r\n        localStorage.setItem(tokenExpiryKey, this.tokenExpiry);\r\n        localStorage.setItem(localStorageKey, 'true');\r\n        localStorage.setItem('userInfo', JSON.stringify({\r\n            displayName: this.profile.name,\r\n            email: this.profile.email,\r\n            photoURL: this.profile.picture,\r\n            providerId: this.profile.sub.substr(0, this.profile.sub.indexOf('|')),\r\n            uid: this.profile.sub\r\n        }));\r\n\r\n        this.emit(loginEvent, {\r\n            loggedIn: true,\r\n            profile: authResult.idTokenPayload,\r\n            state: authResult.appState || {}\r\n        });\r\n    }\r\n\r\n    renewTokens() {\r\n        // reject can be used as parameter in promise for using reject\r\n        return new Promise((resolve) => {\r\n            if (localStorage.getItem(localStorageKey) !== \"true\") {\r\n                // return reject(\"Not logged in\");\r\n            }\r\n\r\n            webAuth.checkSession({}, (err, authResult) => {\r\n                if (err) {\r\n                    // reject(err);\r\n                } else {\r\n                    this.localLogin(authResult);\r\n                    resolve(authResult);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    logOut() {\r\n        localStorage.removeItem(localStorageKey);\r\n        localStorage.removeItem(tokenExpiryKey);\r\n        localStorage.removeItem('userInfo');\r\n\r\n        this.idToken = null;\r\n        this.tokenExpiry = null;\r\n        this.profile = null;\r\n\r\n        webAuth.logout({\r\n            returnTo: window.location.origin + process.env.BASE_URL\r\n        });\r\n\r\n        this.emit(loginEvent, { loggedIn: false });\r\n    }\r\n\r\n    isAuthenticated() {\r\n        return (\r\n            new Date(Date.now()) < new Date(localStorage.getItem(tokenExpiryKey)) &&\r\n            localStorage.getItem(localStorageKey) === 'true'\r\n        );\r\n    }\r\n}\r\n\r\nexport default new AuthService();\r\n"]}]}